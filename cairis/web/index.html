<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <title>CAIRIS Web App</title>
  <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>

  <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
  <link href="plugins/jquery-ui-1.12.1/jquery-ui.css" rel="stylesheet" type="text/css" /> 
  <script src="plugins/jquery-3.1.1/jquery-3.1.1.min.js"></script> 
  <script src="plugins/jquery-ui-1.12.1/jquery-ui.js"></script>
  <script src="plugins/jquery-migrate/jquery-migrate-3.0.0.min.js"></script>
  <link href="plugins/font-awesome-4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
  <link href="plugins/ionicons-2.0.1/css/ionicons.min.css" rel="stylesheet" type="text/css" />
  <script src="bootstrap/js/bootstrap.min.js"></script>
  <script src="plugins/bootstrap-validator/js/validator.js"></script>
  <link rel="stylesheet" href="plugins/mCustomScrollbar/jquery.mCustomScrollbar.css" /> 
  <script src="plugins/jquery-mousewheel/jquery.mousewheel.min.js"></script>
  <script src="plugins/mCustomScrollbar/jquery.mCustomScrollbar.js"></script> 
  <link href="dist/css/CAIRIS.css" rel="stylesheet" type="text/css" />
  <script src="plugins/editableTable/editableRAF.js"></script>
  <script src="dist/js/jquery.session.js"></script>
  <script src="plugins/svg-pan-zoom/svg-pan-zoom.min.js"></script> 
  <script src="plugins/lazyLoad/lazyload.js"></script>
  <script src="plugins/JsonPopulate/jquery.loadJSON.js"></script>
  <script src="plugins/jquery-contextmenu/jquery.contextMenu.min.js"></script>
  <script src="plugins/jquery-contextmenu/jquery.ui.position.min.js"></script>
  <link href="plugins/jquery-contextmenu/jquery.contextMenu.min.css" rel="stylesheet" type="text/css"/>

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
  <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
  <![endif]-->
</head>

<body>
<div class="wrapper">

  <nav class="navbar navbar-inverse">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span> 
        </button>
        <a class="navbar-brand" id="homeClick" href="#" role="button"><span class="glyphicon glyphicon-home"></span> CAIRIS</a>
      </div>
      <div id="navbar" class="left navbar-collapse collapse">
        <ul class="nav navbar-nav">
          <li class="dropdown messages-menu">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"><span class="glyphicon glyphicon-book"></span> System<span class="caret"></span></a>
            <ul class="dropdown-menu">
              <li><a id="newClick" href="#">New</a></li>
              <li><a id="importClick" href="#">Import</a></li>
              <li><a id="exportClick" href="#">Export</a></li>
              <li><a id="genDocClick" href="#">Documentation</a></li>
              <li><a id="projectClick" href="#">Properties</a></li>
            </ul>
          </li>
          <li class="dropdown messages-menu">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"><span class="glyphicon glyphicon-check"> Requirements<span class="caret"></span></a> 
            <ul class="dropdown-menu">
              <li><a id="requirementsClick" href="#">Requirements</a></li>
              <li><a id="domainPropertyMenuClick" href="#">Domain Properties</a></li>
              <li><a id="goalMenuClick" href="#">Goals</a></li>
              <li><a id="obstacleMenuClick" href="#">Obstacles</a></li>
              <li><a id="useCaseClick" href="#">Use Cases</a></li>
              <li><a id="dependenciesClick" href="#">Dependencies</a></li>
              <li><a id="architecturalPatternsClick" href="#">Architectural Patterns</a></li>
            </ul>
          </li>
          <li class="dropdown messages-menu">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"><span class="glyphicon glyphicon-flash"> Risk<span class="caret"></span></a>
            <ul class="dropdown-menu">
              <li><a id="roleMenuClick" href="#">Roles</a></li>
              <li><a id="assetMenuClick" href="#">Assets</a></li>
              <li><a id="assetAssociationMenuClick" href="#">Asset Associations</a></li>
              <li><a id="attackerMenuClick" href="#">Attackers</a></li>
              <li><a id="threatMenuClick" href="#">Threats</a></li>
              <li><a id="vulnerabilityMenuClick" href="#">Vulnerabilities</a></li>
              <li><a id="riskMenuClick" href="#">Risks</a></li>
              <li><a id="responseMenuClick" href="#">Responses</a></li>
              <li><a id="countermeasureMenuClick" href="#">Countermeasures</a></li>
            </ul>
          </li>
          <li class="dropdown messages-menu">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"><span class="glyphicon glyphicon-user"> UX<span class="caret"></span></a>
            <ul class="dropdown-menu">
              <li><a id="environmentMenuClick" href="#">Environments</a></li>
              <li><a id="personaMenuClick" href="#">Personas</a></li>
              <li><a id="taskMenuClick" href="#">Tasks</a></li>
              <li><a id="externalDocumentsClick" href="#">External Documents</a></li>
              <li><a id="documentReferencesClick" href="#">Document References</a></li>
              <li><a id="personaCharacteristicsClick" href="#">Persona Characteristics</a></li>
            </ul>
          </li>
          <li class="dropdown messages-menu">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"><span class="glyphicon glyphicon-picture"> Models<span class="caret"></span></a>
            <ul class="dropdown-menu">
              <li><a id="riskModelClick" href="#">Risk</a></li>
              <li><a id="assetModelClick" href="#">Asset</a></li>
              <li><a id="goalModelClick" href="#">Goal</a></li>
              <li><a id="obstacleModelClick" href="#">Obstacle</a></li>
              <li><a id="responsibilityModelClick" href="#">Responsibility</a></li>
              <li><a id="taskModelClick" href="#">Task</a></li>
              <li><a id="personaModelClick" href="#">Persona</a></li>
            </ul>
          </li>
          <li class="dropdown messages-menu">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"><span class="glyphicon glyphicon-wrench"> Options<span class="caret"></span></a>
            <ul class="dropdown-menu">
              <li><a id="assetValuesClick" href="#">Asset Values</a></li>
              <li><a id="assetTypesClick" href="#">Asset Types</a></li>
              <li><div class="divider"></li>
              <li><a id="accessRightsClick" href="#">Access Rights</a></li>
              <li><a id="protocolsClick" href="#">Protocols</a></li>
              <li><a id="privilegesClick" href="#">Privileges</a></li>
              <li><a id="surfaceTypesClick" href="#">Surface Types</a></li>
              <li><div class="divider"></li>
              <li><a id="vulnerabilityTypesClick" href="#">Vulnerability Types</a></li>
              <li><a id="vulnerabilitySeveritiesClick" href="#">Vulnerability Severities</a></li>
              <li><a id="capabilitiesClick" href="#">Capabilities</a></li>
              <li><a id="motivationsClick" href="#">Motivations</a></li>
              <li><a id="threatTypesClick" href="#">Threat Types</a></li>
              <li><a id="threatLikelihoodsClick" href="#">Threat Likelihoods</a></li>
              <li><a id="threatValuesClick" href="#">Threat Values</a></li>
              <li><a id="riskValuesClick" href="#">Risk Values</a></li>
              <li><div class="divider"></li>
              <li><a id="templateAssetsClick" href="#">Template Assets</a></li>
              <li><a id="templateRequirementsClick" href="#">Template Requirements</a></li>
              <li><a id="countermeasureValuesClick" href="#">Countermeasure Values</a></li>
            </ul>
          </li>
        
          <div class="col-sm-3 col-md-3">
            <form class="navbar-form" role="search">
              <div class="input-group">
                <input type="text" class="form-control" placeholder="Search" id="theSearchString" name="theSearchString">
                <div class="input-group-btn">
                  <button class="btn btn-default" id="FindButton" type="submit"><i class="glyphicon glyphicon-search"></i></button>
                </div>
              </div>
            </form>
          </div> 

        </ul>
      </div>
    </div>
  </nav>
  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header" style="margin-left: 5px; margin-right: 5px; margin-bottom: 5px;">
      <div id="filtercontent" class="extraContent row form-group">
        <div class="col-md-1">
          <label class="topCombobox control-label">Assets</label>
        </div>
        <div class="col-md-2">
          <select class="topCombobox form-control" id="assetsbox" ></select>
        </div>
        <div class="col-md-2">
          <label class="topCombobox control-label" for="environmentsbox">Environments</label>
        </div>
        <div class="col-md-2">
          <select class="topCombobox form-control" id="environmentsbox"></select>
        </div>
      </div>

      <div id="filtergoalmodelcontent" class="extraContent row form-group" style="display:none">
        <div class="col-md-1">
          <label  class="topCombobox control-label" for="gmenvironmentsbox">Environment</label>
        </div>
        <div class="col-md-2">
          <select class="topCombobox form-control" id="gmenvironmentsbox" ></select>
        </div>
        <div class="col-md-1">
          <label class="topCombobox control-label" for="gmgoalbox">Goal</label>
        </div>
        <div class="col-md-2">
          <select class="topCombobox form-control" id="gmgoalbox"></select>
        </div>
        <div class="col-md-1">
          <label  class="topCombobox control-label" for="gmusecasebox">Use Case</label>
        </div>
        <div class="col-md-2">
          <select class="topCombobox form-control" id="gmusecasebox"></select>
        </div>
      </div>
      <div id="filterobstaclemodelcontent" class="extraContent row form-group" style="display:none">
        <div class="col-md-1">
          <label class="topCombobox control-label" for="omenvironmentsbox">Environment</label>
        </div>
        <div class="col-md-2">
          <select class="topCombobox form-control" id="omenvironmentsbox" ></select>
        </div>
        <div class="col-md-1">
          <label  class="topCombobox control-label" for="omobstaclebox">Obstacle</label>
        </div>
        <div class="col-md-2">
          <select class="topCombobox form-control" id="omobstaclebox"></select>
        </div>
      </div>
      <div id="filterresponsibilitymodelcontent" class="extraContent row form-group" style="display:none">
        <div class="col-md-1">
          <label  class="topCombobox control-label" for="remenvironmentsbox">Environment</label>
        </div>
        <div class="col-md-2">
          <select class="topCombobox form-control" id="remenvironmentsbox" ></select>
        </div>
        <div class="col-md-1">
          <label  class="topCombobox control-label" for="remrolebox">Role</label>
        </div>
        <div class="col-md-2">
          <select class="topCombobox form-group" id="remrolebox"></select>
        </div>
      </div>
      <div id="filtertaskmodelcontent" class="extraContent row form-group" style="display:none">
        <div class="col-md-1">
          <label  class="topCombobox control-label" for="tmenvironmentsbox">Environment</label>
        </div>
        <div class="col-md-2">
          <select class="topCombobox form-control" id="tmenvironmentsbox" ></select>
        </div>
        <div class="col-md-1">
          <label class="topCombobox control-label" for="tmtaskbox">Task</label>
        </div>
        <div class="col-md-2">
          <select class="topCombobox form-control" id="tmtaskbox"></select>
        </div>
        <div class="col-md-1">
          <label  class="topCombobox control-label" for="tmmisusecasebox">Misuse Case</label>
        </div>
        <div class="col-md-1">
          <select class="topCombobox form-control" id="tmmisusecasebox"></select>
        </div>
      </div>
      <div id="filterapmodelcontent" class="extraContent row form-group" style="display:none">
        <div class="col-md-1">
          <label class="topCombobox control-label" for="appersonasbox">Persona</label>
        </div>
        <div class="col-md-1">
          <select class="topCombobox form-control" id="appersonasbox" ></select>
        </div>
        <div class="col-md-1">
          <label class="topCombobox control-label" for="apbtbox">Behaviour Type</label>
        </div>
        <div class="col-md-2">
          <select class="topCombobox form-control" id="apbtbox">
            <option value="All">All</option>
            <option value="Activities">Activities</option>
            <option value="Attitudes">Attitudes</option>
            <option value="Aptitudes">Aptitudes</option>
            <option value="Motivations">Motivations</option>
            <option value="Skills">Skills</option>
            <option value="Environment Narrative">Environment Narrative</option>
            <option value="Intrinsic">Intrinsic</option>
            <option value="Contextual">Contextual</option>
          </select>
        </div>
        <div class="col-md-1">
          <label class="topCombobox control-label" for="apcharacteristicbox">Characteristic</label>
        </div>
        <div class="col-md-2">
          <select class="topCombobox form-control" id="apcharacteristicbox"></select>
        </div>
      </div>
      <div id="filterriskmodelcontent" class="extraContent row form-group" style="display:none">
        <div class="col-md-1">
          <label class="topCombobox control-label" for="rmenvironmentsbox">Environment</label>
        </div>
        <div class="col-md-2">
          <select class="topCombobox form-control" id="rmenvironmentsbox" ></select>
        </div>
        <div class="col-md-1">
          <label class="topCombobox control-label" for="rmdimensionbox">Type</label>
        </div>
        <div class="col-md-2">
          <select class="topCombobox form-control" id="rmdimensionbox">
            <option value="all">All</option>
            <option value="asset">Asset</option>
            <option value="attacker">Attacker</option>
            <option value="countermeasure">Countermeasure</option>
            <option value="misusecase">Misuse Case</option>
            <option value="obstacle">Obstacle</option>
            <option value="requirement">Requirement</option>
            <option value="response">Response</option>
            <option value="risk">Risk</option>
            <option value="role">Role</option>
            <option value="task">Task</option>
            <option value="threat">Threat</option>
            <option value="vulnerability">Vulnerability</option>
          </select>
        </div>
        <div class="col-md-1">
          <label  class="topCombobox control-label" for="rmobjectbox">Name</label>
        </div>
        <div class="col-md-2">
          <select class="topCombobox form-control" id="rmobjectbox"></select>
        </div>
        <div class="col-md-1">
          <label class="topCombobox control-label" for="rmlayout">Type</label>
        </div>
        <div class="col-md-2">
          <select class="topCombobox form-control" id="rmlayout">
            <option value="Hierarchical">Hierarchical</option>
            <option value="Spring">Spring</option>
            <option value="Radial">Radial</option>
            <option value="Circular">Circular</option>
          </select>
        </div>
      </div>
      <div id="filterassetmodelcontent" class="extraContent row form-group">
        <div class="col-md-1">
          <label class="topCombobox control-label" for="amassetsbox">Assets</label>
        </div>
        <div class="col-md-2">
          <select class="topCombobox form-control" id="amassetsbox" ></select>
        </div>
        <div class="col-md-2">
          <label class="topCombobox control-label" for="amenvironmentsbox">Environments</label>
        </div>
        <div class="col-md-2">
          <select class="topCombobox form-control" id="amenvironmentsbox" ></select>
        </div>
        <div class="col-md-1">
          <label class="topCombobox control-label" for="amconcernsbox">Hide Concerns</label>
        </div>
        <div class="col-md-2">
          <select class="topCombobox form-control" id="amconcernsbox">
            <option value="Yes">Yes</option>
            <option value="No">No</option>
          </select>
        </div>
      </div>
    </section>
    <!-- Main content -->
    <section id="maincontent" class="content" style="margin-left: 5px; margin-right: 5px">
      <table id="reqTable"class="theTable table table-striped table-bordered sortable">
        <thead class="thead-inverse"></thead>
        <tbody>
        </tbody>
      </table>
      <div id="homePanel"></div>
      <div id="svgViewer"></div>
      <div id="objectViewer" class="no-print"></div>
    </section><!-- /.content -->
    </div><!-- /.content-wrapper -->
    <!-- rightnav -->
    <div id="rightnavGear" class="no-print"
      style="display:none;position: fixed; top: 100px; right: 0px; border-radius: 5px 0px 0px 5px; padding: 10px 15px; font-size: 16px; z-index: 100; cursor: pointer; color: rgb(60, 141, 188); box-shadow: rgba(0, 0, 0, 0.0980392) 0px 1px 3px; background: rgb(255, 255, 255);">
      <i class="fa fa-gear"></i>
    </div>
    <div id="rightnavMenu" class="no-print"
      style="padding: 10px; position: fixed; top: 100px; right: -750px; border: 0px solid rgb(221, 221, 221); width: 750px; z-index: 100; box-shadow: rgba(0, 0, 0, 0.0980392) 0px 1px 3px; background: rgb(255, 255, 255);">
      <h4 id="optionsHeaderGear" class="text-light-blue" style="margin: 0 0 5px 0; border-bottom: 1px solid #ddd; padding-bottom: 15px;">Options</h4>
      <div id="optionsContent"></div>
    </div>
    <footer class="main-footer">
      <!-- Default to the left -->
      <div id="inform"></div>
    </footer>
    <!-- The configuration dialog window-->
  </div>
  <div class="comboboxD" id="comboboxDialog" title="Dialog">
    <label for="comboboxDialogSelect" class="control-label"> Choose the environment</label>
    <select class="comboboxD form-control" id="comboboxDialogSelect">
    </select>
  </div>
  <div id="errorDialog" title="ERROR">
    <p style="color: black">You can't use CAIRIS without any settings</p>
  </div>
  <div id="reportObjectDependencies" title="Delete " style="display: none">
    <label class="control-label">Removing this object will also remove the following objects.</label>
    <table id="objectDependencyTable" class="table-striped table-bordered">
      <thead>
        <tr><th>Artifact</th><th>Name</th></tr>
      </thead>
      <tbody>
      </tbody>
    </table>
    <label class="control-label">Do you want to continue?</label>
  </div>
  <div class="popupMessage" style="display:none;" >
    <div class="Succes"><i class="fa fa-check fa-2x"></i><div class="infoText">Success</div></div>
    <div class="Fail"><i class="fa fa-exclamation fa-2x"></i><div class="infoText">Something went wrong...<p class="faultInfo"></p></div></div>
  </div>
  <div id="ChooseAssetDialog" title="Choose an Asset" style="display: none">
    <select class="form-control">
    </select>
  </div>
  <div id="ChooseConcernDialog" title="Choose a task concern" style="display: none">
    <select class="form-control">
    </select>
  </div>
  <div id="ChooseRoleDialog" title="Choose a role" style="display: none">
    <select class="form-control">
    </select>
  </div>
  <div id="EnterUseCaseStep" title="Enter use case step" style="display: none">
    <textarea id="theStep" style="width: 100%" class="form-control"></textarea>
  </div>
  <div id="ChooseMotivationsDialog" title="Choose a motivation" style="display: none">
    <select class="form-control">
    </select>
  </div>
  <div id="ChooseEnvAssetsDialog" title="Choose a motivation" style="display: none">
    <select class="form-control">
    </select>
  </div>
  <div id="ChooseRoleForResponse" title="Add a role cost" style="display: none">
    <label for="theNewRole" class="control-label">Role</label>
    <select id="theNewRole" class="form-control">
    </select>
    <br/>
    <label for="theRoleCost" class="control-label">Cost</label>
    <select id="theRoleCost" class="form-control">
      <option>Low</option>
      <option>Medium</option>
      <option>High</option>
    </select>
  </div>
  <div id="ChoosePersonaForTask" title="Add a participating persona" style="display: none">
    <label for="theTaskPersona" class="control-label">Persona</label>
    <select class="form-control" id="theTaskPersona">
    </select>
    <br/>
    <label for="theTaskDuration" class="control-label">Duration</label>
    <select class="form-control" id="theTaskDuration">
      <option id="Low">Seconds</option>
      <option id="Medium">Minutes</option>
      <option id="High">Hours or Longer</option>
    </select>
    <label for="theTaskFrequency" class="control-label">Frequency</label>
    <select class="form-control" id="theTaskFrequency">
      <option id="Low">Hours or more</option>
      <option id="Medium">Daily - Weekly</option>
      <option id="High">Monthly or less</option>
    </select>
    <label for="theTaskDemands" class="control-label">Demands</label>
    <select id="theTaskDemands" class="form-control">
      <option id="None">None</option>
      <option id="Low">Low</option>
      <option id="Medium">Medium</option>
      <option id="High">High</option>
    </select>
    <label for="theTaskGoalConflict" class="control-label">Goal Conflict</label>
    <select id="theTaskGoalConflict" class="form-control">
      <option id="None">None</option>
      <option id="Low">Low</option>
      <option id="Medium">Medium</option>
      <option id="High">High</option>
    </select>
  </div>
  <div id="typeOfFile" title="Which type?" class="form-group" style="display: none">
    <select name="theImportModelType" id="theImportModelType" class="form-control">
      <option>Model</option>
      <option>Project data</option>
      <option>Requirements</option>
      <option>Risk Analysis</option>
      <option>Usability</option>
      <option>Associations</option>
      <option>Threat and Vulnerability Types</option>
      <option>Domain Values</option>
      <option>Threat and Vulnerability Directory</option>
      <option>Security Pattern</option>
      <option>Architectural Pattern</option>
      <option>Attack Pattern</option>
      <option>Synopses</option>
      <option>Assets</option>
      <option>Processes</option>
    </select>
    <input class="form-control" type="file" accept="text/xml" onchange="readImportFile(event)" id="theImportModelFile" name="theImportModelFile" />
  </div>
  <div class="loadingWrapper">
    <div class="divLoading">
    </div>
  </div>
  <script>
    var reqTabl =  $('#reqTable').editableTableWidget({editor: $('<textarea>')});
    //  if the table is been scrolled, it needs to be out of focus
    $('#maincontent').scroll(function(){
      $('#reqTable').find('td:first').focus();
      $('#reqTable').find('td:last').focus();
    });
    $("#comboboxDialog").hide();
    $("#debugID").click(function () {
        putThreat("{}", "NoName");
    })
  </script>

  <!-- REQUIRED JS SCRIPTS -->
  <!-- Slimscroll App  -->
  <script src="plugins/slimScroll/jquery.slimscroll.js" type="text/javascript"></script>
  <script>
    LazyLoad.js(["dist/js/cairis/Cairis-UI.js","dist/js/cairis/buttonclicks.js", "dist/js/cairis/Cairis.js", "dist/js/cairis/readFile.js",
        "dist/js/cairis/threats.js", "dist/js/cairis/attackers.js", "dist/js/cairis/personas.js", "dist/js/cairis/assets.js", "dist/js/cairis/goals.js", "dist/js/cairis/projectSettings.js", "dist/js/cairis/tasks.js", "dist/js/cairis/domainproperties.js", "dist/js/cairis/obstacles.js", "dist/js/cairis/countermeasures.js", "dist/js/cairis/usecases.js","dist/js/cairis/vulnerabilities.js","dist/js/cairis/architecturalpatterns.js",
        "dist/js/cairis/risks.js", "dist/js/cairis/fileImport.js", "dist/js/cairis/fileExport.js", "dist/js/cairis/responses.js","dist/js/cairis/dependencies.js","dist/js/cairis/genDoc.js","dist/js/cairis/findobjt.js","dist/js/cairis/externaldocuments.js","dist/js/cairis/documentreferences.js","dist/js/cairis/personacharacteristics.js","dist/js/cairis/homeSettings.js","dist/js/cairis/roles.js","dist/js/cairis/environments.js","dist/js/cairis/valuetypes.js",
        "dist/js/cairis/SVGhandler.js","dist/js/cairis/PutAndPost.js", "dist/js/objects/jsonDefaultObjects.js"], function () {

      console.log("All Cairis JS loaded");
    });
</script>

<!-- For the basic page, keeping it separate from the Cairis jQuery
<script src="dist/js/Cairis-UI.js" type="text/javascript"></script>
<!-- The jQuery for the pages
<script src="dist/js/Cairis.js" type="text/javascript"></script>-->

</body>
</html>
